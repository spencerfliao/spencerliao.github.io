
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ETL for AI-Powered Messaging &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'etl-for-llm-sales-messaging_nob';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="N-grams Pattern-mining in Menus" href="codeswitching-corpus-mining_nob.html" />
    <link rel="prev" title="Welcome to my Project Collection" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpeg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.jpeg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to my Project Collection
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">ETL for AI-Powered Messaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="codeswitching-corpus-mining_nob.html">N-grams Pattern-mining in Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="llm-reasoning-graphic-puzzles.html">Enhancing LLM Visual Reasoning</a></li>
<li class="toctree-l1"><a class="reference internal" href="multilingual-text-detox.html">Multilingual Text Detoxification</a></li>
<li class="toctree-l1"><a class="reference internal" href="brand.html">Brand Linguistic Insights &amp; Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design Training &amp; Portfolio</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fetl-for-llm-sales-messaging_nob.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/etl-for-llm-sales-messaging_nob.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ETL for AI-Powered Messaging</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-objectives">Project Objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline-architecture">Pipeline Architecture</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-functionality">1. Search Functionality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parse-functionality">2. Parse Functionality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">3. Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-of-sections">Post-Processing of sections</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimenting-with-llm">Experimenting with LLM</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="etl-for-ai-powered-messaging">
<h1>ETL for AI-Powered Messaging<a class="headerlink" href="#etl-for-ai-powered-messaging" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>This repository presents a redacted, simulated version of a capstone project developed under NDA with a Canadian AI company. It illustrates generalizable techniques in ETL, information extraction, and preparation for LLM message generation workflows.</p>
</div></blockquote>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This project focuses on building a robust and scalable data pipeline that extracts structured information from public 10-K annual reports. The extracted features are designed to support downstream AI applications, such as personalized sales message generation using LLMs. The pipeline is optimized to handle noisy, unstructured HTML documents, and scale across thousands of companies.</p>
<p><a class="reference external" href="https://docs.google.com/presentation/d/1E5HGHGIrSbLAhTI5gE3Lx6DWvD-1scxTr3RYDzV9ems/edit">View Presentation Slides</a></p>
<p><a class="reference external" href="https://github.com/spencerfliao/etl-for-llm-sales-messaging/blob/1a6e655edab99ad14279b28e673204801ce67f15/report.pdf">View Full Project Report</a></p>
<section id="project-objectives">
<h3>Project Objectives<a class="headerlink" href="#project-objectives" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Parse public 10-K filings and extract meaningful company-level attributes</p></li>
<li><p>Design scalable ETL pipelines suitable for integration with a relational database</p></li>
<li><p>Enhance the feature coverage and specificity of company profiles for downstream use</p></li>
<li><p>Prepare data for use in RAG pipelines to power AI-generated outreach messages</p></li>
</ul>
</section>
<section id="pipeline-architecture">
<h3>Pipeline Architecture<a class="headerlink" href="#pipeline-architecture" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>SEC 10-K Filings (HTML)</strong> – Raw HTML filings as input</p></li>
<li><p><strong>HTML Preprocessing &amp; Parsing</strong> – Extracts relevant sections and cleans up formatting</p></li>
<li><p><strong>Section Segmentation</strong> – Breaks documents into logical units (e.g. Risk Factors, Business Overview)</p></li>
<li><p><strong>Information Extraction Scripts</strong> – Pulls key terms, metrics, and attributes</p></li>
<li><p><strong>Feature Dictionary Construction</strong> – Builds structured representations for each company</p></li>
<li><p><strong>Structured Output</strong> – Saves as CSV or JSON</p></li>
<li><p><strong>(Optional) Database Upload</strong> – Prepared for integration into PostgreSQL</p></li>
</ol>
<p><strong>Team Members:</strong></p>
<ul class="simple">
<li><p>Spencer Liao</p></li>
<li><p>Haochen He</p></li>
<li><p>Desmond Bai</p></li>
<li><p>Daniel Jimenez</p></li>
</ul>
<p><strong>Supervisors:</strong></p>
<ul class="simple">
<li><p>Miikka Silfverberg | UBC Professor</p></li>
<li><p>Partner Company Team</p></li>
</ul>
<hr class="docutils" />
<p>Imports</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fuzzywuzzy</span><span class="w"> </span><span class="kn">import</span> <span class="n">process</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fuzzywuzzy</span><span class="w"> </span><span class="kn">import</span> <span class="n">process</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;fuzzywuzzy&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="search-functionality">
<h2>1. Search Functionality<a class="headerlink" href="#search-functionality" title="Link to this heading">#</a></h2>
<p>Function to quickly get BeautifulSoup from requests</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_soup</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&quot;</span><span class="p">})</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">soup</span>
</pre></div>
</div>
</div>
</div>
<p>Function that searches for CIK on SEC EDGAR using company name, returns either single or list of results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">search_cik</span><span class="p">(</span><span class="n">company_name</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fetch_data</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="n">search_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://www.sec.gov/cgi-bin/browse-edgar?company=</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&amp;match=&amp;filenum=&amp;State=&amp;Country=&amp;SIC=&amp;owner=exclude&amp;Find=Find+Companies&amp;action=getcompany&#39;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">search_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Failed to fetch data&quot;</span>

        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>

        <span class="c1"># Check if it&#39;s a detailed single company page</span>
        <span class="n">company_info</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;companyInfo&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">company_info</span><span class="p">:</span>
            <span class="n">cik</span> <span class="o">=</span> <span class="n">company_info</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
            <span class="n">company_name</span> <span class="o">=</span> <span class="n">company_info</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;companyName&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; CIK&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">cik</span><span class="p">,</span> <span class="n">company_name</span>

        <span class="c1"># Check if it&#39;s a list of companies</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;tableFile2&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table</span><span class="p">:</span>
            <span class="n">companies</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                <span class="n">cik</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">company_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">companies</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cik</span><span class="p">,</span> <span class="n">company_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">companies</span>

        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="n">key</span> <span class="o">=</span> <span class="n">company_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;%26&#39;</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">fetch_data</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;corporation&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;corporation&#39;</span><span class="p">,</span> <span class="s1">&#39;corp&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fetch_data</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;group&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fetch_data</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fetch_data</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39; and &#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; and &#39;</span><span class="p">,</span> <span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fetch_data</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;company&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="s1">&#39;co&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fetch_data</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">result</span>

<span class="n">search_cik</span><span class="p">(</span><span class="s1">&#39;Intercom&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Fuctions that finds the best match and produces the CIK url</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_cik_url</span><span class="p">(</span><span class="n">company_name</span><span class="p">):</span>
    <span class="n">search_result</span> <span class="o">=</span> <span class="n">search_cik</span><span class="p">(</span><span class="n">company_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">search_result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">search_result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">cik</span> <span class="o">=</span> <span class="n">search_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">search_result</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">search_result</span><span class="p">:</span>
        <span class="c1"># Use fuzzy matching to find the closest result</span>
        <span class="n">company_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_result</span><span class="p">]</span>
        
        <span class="c1"># Perform fuzzy matching</span>
        <span class="n">closest_matches</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">company_name</span><span class="p">,</span> <span class="n">company_names</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="c1"># Filter and prioritize exact matches or highly similar ones</span>
        <span class="n">best_match</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">highest_score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">closest_matches</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">match</span>
            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">highest_score</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;inc&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;corp&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="n">highest_score</span> <span class="o">=</span> <span class="n">score</span>
                <span class="n">best_match</span> <span class="o">=</span> <span class="n">name</span>
        
        <span class="c1"># Initialize cik with a default value</span>
        <span class="n">cik</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="c1"># Find the CIK for the best match</span>
        <span class="k">if</span> <span class="n">best_match</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_result</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_match</span><span class="p">:</span>
                    <span class="n">cik</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">break</span>

        <span class="c1"># If no suitable match is found, fallback to the closest match</span>
        <span class="k">if</span> <span class="n">cik</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">closest_match</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">extractOne</span><span class="p">(</span><span class="n">company_name</span><span class="p">,</span> <span class="n">company_names</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_result</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">closest_match</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">cik</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">if</span> <span class="n">cik</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="n">cik_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&amp;CIK=</span><span class="si">{</span><span class="n">cik</span><span class="si">}</span><span class="s1">&amp;type=10-K&amp;dateb=&amp;owner=exclude&amp;count=40&#39;</span>
    <span class="k">return</span> <span class="n">cik_url</span>

<span class="n">cik_url</span> <span class="o">=</span> <span class="n">get_cik_url</span><span class="p">(</span><span class="s1">&#39;Blue Buffalo&#39;</span><span class="p">)</span>
<span class="n">cik_url</span>
</pre></div>
</div>
</div>
</div>
<p>Function to get the url to 10-K filing document in HTML format, with CIK url as key</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_10k_url</span><span class="p">(</span><span class="n">cik_url</span><span class="p">):</span>
    <span class="n">soup1</span> <span class="o">=</span> <span class="n">get_soup</span><span class="p">(</span><span class="n">cik_url</span><span class="p">)</span>

    <span class="n">filing_detail_url</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">html_url</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">link1</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">link2</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># finding the first 10-K link on the CIK page -&gt; filing detail</span>
    <span class="n">table_rows_1</span> <span class="o">=</span> <span class="n">soup1</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_rows_1</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;10-K&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">text</span> <span class="ow">and</span> <span class="s1">&#39;10-K/A&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">link1</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">link1</span><span class="p">:</span>
        <span class="n">filing_detail_url</span> <span class="o">=</span> <span class="s1">&#39;https://www.sec.gov&#39;</span> <span class="o">+</span> <span class="n">link1</span>

        <span class="n">soup2</span> <span class="o">=</span> <span class="n">get_soup</span><span class="p">(</span><span class="n">filing_detail_url</span><span class="p">)</span>
        <span class="n">table_rows_2</span> <span class="o">=</span> <span class="n">soup2</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>

        <span class="c1"># finding 10-k doc from filing detail page</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_rows_2</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;10-K&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="n">link2</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">link2</span><span class="p">:</span>
            <span class="n">xbrl_url</span> <span class="o">=</span> <span class="s1">&#39;https://www.sec.gov&#39;</span> <span class="o">+</span> <span class="n">link2</span>
            <span class="n">html_url</span> <span class="o">=</span> <span class="n">xbrl_url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ix?doc=/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">html_url</span>

<span class="n">html_url</span> <span class="o">=</span> <span class="n">get_10k_url</span><span class="p">(</span><span class="n">cik_url</span><span class="p">)</span>
<span class="n">html_url</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;https://www.sec.gov/Archives/edgar/data/1609989/000160998918000019/bluebuffalo12311710-k.htm&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_10k_file</span><span class="p">(</span><span class="n">html_url</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">html_url</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">html_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&quot;</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="parse-functionality">
<h2>2. Parse Functionality<a class="headerlink" href="#parse-functionality" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">html_url</span> <span class="o">=</span> <span class="n">get_10k_url</span><span class="p">(</span><span class="n">cik_url</span><span class="p">)</span>
<span class="n">doc_10k</span> <span class="o">=</span> <span class="n">get_10k_file</span><span class="p">(</span><span class="n">html_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Function to find all section title names</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span><span class="p">,</span> <span class="n">Tag</span>

<span class="k">def</span><span class="w"> </span><span class="nf">extract_sections_titles</span><span class="p">(</span><span class="n">html_content</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_content</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Find all &#39;table tr&#39; elements</span>
    <span class="n">table_rows</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Business&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">parent_node</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">for</span> <span class="n">sibling</span> <span class="ow">in</span> <span class="n">parent_node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>  <span class="c1"># Check if the sibling is a Tag object</span>
                    <span class="n">a_tags</span> <span class="o">=</span> <span class="n">sibling</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
                    <span class="n">combined_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">a_tag</span> <span class="ow">in</span> <span class="n">a_tags</span><span class="p">:</span>
                        <span class="n">text</span> <span class="o">=</span> <span class="n">a_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="c1"># Skip page numbers, signatures, and ensure href is assigned only once</span>
                        <span class="k">if</span> <span class="n">text</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">text</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;signature&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;item&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;part&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                            <span class="n">combined_text</span> <span class="o">+=</span> <span class="n">text</span>
                    <span class="k">if</span> <span class="n">combined_text</span> <span class="ow">and</span> <span class="n">combined_text</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
                        <span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combined_text</span><span class="p">)</span>
                        
    <span class="k">return</span> <span class="n">sections</span>
</pre></div>
</div>
</div>
</div>
<p>Function to find all section title names and href links</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">extract_section_and_links</span><span class="p">(</span><span class="n">html_content</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_content</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># Find all &#39;table tr&#39; elements</span>
    <span class="n">table_rows</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Business&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">parent_node</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">for</span> <span class="n">sibling</span> <span class="ow">in</span> <span class="n">parent_node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="n">a_tags</span> <span class="o">=</span> <span class="n">sibling</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
                <span class="n">combined_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">href</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">a_tag</span> <span class="ow">in</span> <span class="n">a_tags</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="n">a_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="c1"># Skip page numbers, signatures, and ensure href is assigned only once</span>
                    <span class="k">if</span> <span class="n">text</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">text</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;signature&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;item&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;part&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="n">combined_text</span> <span class="o">+=</span> <span class="n">text</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">href</span><span class="p">:</span>
                            <span class="n">href</span> <span class="o">=</span> <span class="n">a_tag</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">combined_text</span><span class="p">:</span>
                    <span class="n">sections</span><span class="p">[</span><span class="n">combined_text</span><span class="p">]</span> <span class="o">=</span> <span class="n">href</span>
                        
    <span class="k">return</span> <span class="n">sections</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">section_links</span> <span class="o">=</span> <span class="n">extract_section_and_links</span><span class="p">(</span><span class="n">doc_10k</span><span class="p">)</span>
<span class="n">sections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">section_links</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Section Title&#39;</span><span class="p">,</span> <span class="s1">&#39;Link&#39;</span><span class="p">])</span>
<span class="n">sections_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Section Title</th>
      <th>Link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Business</td>
      <td>sCFD89D1EFF2E5293B86B54AFC1B3E429</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Risk Factors</td>
      <td>sE0B3F0F9C141501D99BC795B94F63D64</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Unresolved Staff Comments</td>
      <td>s9302553BB168589C93C7FC833AF6EA4F</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Properties</td>
      <td>sECEB3774BEDD5B739B854E5E8489C0D4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Legal Proceedings</td>
      <td>sA147E4A7EE1C5F59A27CF898FA0C3F54</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mine Safety Disclosures</td>
      <td>s4D666224DFE7509C91EDA75AC0A2B315</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Market for the Registrant’s Common Equity, Rel...</td>
      <td>s810C1C726DBF523C81382B1D16F1148D</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Selected Financial Data</td>
      <td>sE916212FBD485BA9857CCDA87D452815</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Management’s Discussion and Analysis of Financ...</td>
      <td>sDD8D7E29282A5C5B828C887406C7ED20</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Quantitative and Qualitative Disclosures about...</td>
      <td>s1A0401606D2857BFACCDB8FDD3658E17</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Financial Statements and Supplementary Data</td>
      <td>s6DF8710BCDEE51A6AB502170A885F9FF</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Changes in and Disagreements with Accountants ...</td>
      <td>s02ED851F21BA50D486C1D6ECD1F0FA61</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Controls and Procedures</td>
      <td>sCFFD547FE36258C683D583AC369EE63B</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Other Information</td>
      <td>s339305EF066354CBBB088654E4F9BD0D</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Directors, Executive Officers and Corporate Go...</td>
      <td>s02399A9B0F2D5371BF807EABE25D5936</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Executive Compensation</td>
      <td>s6D7683D9DF635408924F618A48A5ED33</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Security Ownership of Certain Beneficial Owner...</td>
      <td>sDBE6D9382657532A8ABC1CAD62D0DAF1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Certain Relationships and Related Transactions...</td>
      <td>s69AAF3B2AC9354DBBF2A80C810F435B6</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Principal Accounting Fees and Services</td>
      <td>s781F6D53FBE55CEB97ECE64895F4350C</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Exhibits and Financial Statement Schedules</td>
      <td>sC1D9600246F352848540A930C26B671B</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Form 10-K Summary</td>
      <td>s7AA497D298E85E7B941EC150E95ED4A6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">extract_sections</span><span class="p">(</span><span class="n">html_content</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_content</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">table_rows</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
    <span class="n">links_to_process</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Business&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="s1">&#39;Risk Factors&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>  <span class="c1"># Example section titles</span>
            <span class="n">parent_node</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">for</span> <span class="n">sibling</span> <span class="ow">in</span> <span class="n">parent_node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span><span class="p">,</span> <span class="n">Tag</span><span class="p">):</span>
                    <span class="n">a_tags</span> <span class="o">=</span> <span class="n">sibling</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
                    <span class="n">combined_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">href</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">a_tag</span> <span class="ow">in</span> <span class="n">a_tags</span><span class="p">:</span>
                        <span class="n">text</span> <span class="o">=</span> <span class="n">a_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">text</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">text</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;signature&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;item&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;part&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                            <span class="n">combined_text</span> <span class="o">+=</span> <span class="n">text</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">href</span><span class="p">:</span>
                                <span class="n">href</span> <span class="o">=</span> <span class="n">a_tag</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">combined_text</span> <span class="ow">and</span> <span class="n">href</span><span class="p">:</span>
                        <span class="n">links_to_process</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">combined_text</span><span class="p">,</span> <span class="n">href</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">combined_text</span><span class="p">,</span> <span class="n">href</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">links_to_process</span><span class="p">):</span>
        <span class="n">section_div</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">href</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">section_div</span><span class="p">:</span>
            <span class="n">section_div</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">href</span><span class="p">})</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">section_div</span><span class="p">:</span>
            <span class="n">section_div</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">href</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">section_div</span><span class="p">:</span>
                <span class="n">section_div</span> <span class="o">=</span> <span class="n">section_div</span><span class="o">.</span><span class="n">parent</span>

        <span class="n">section_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">section_div</span><span class="p">:</span>
            <span class="n">next_node</span> <span class="o">=</span> <span class="n">section_div</span><span class="o">.</span><span class="n">find_next_sibling</span><span class="p">()</span>
            <span class="n">next_href</span> <span class="o">=</span> <span class="n">links_to_process</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">links_to_process</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">while</span> <span class="n">next_node</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">next_node</span><span class="o">.</span><span class="n">attrs</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">next_node</span><span class="o">.</span><span class="n">attrs</span> <span class="ow">and</span> <span class="n">next_node</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">next_href</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">next_node</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">next_node</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;hr&#39;</span><span class="p">:</span>
                    <span class="n">section_content</span> <span class="o">+=</span> <span class="n">next_node</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">separator</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">next_node</span> <span class="o">=</span> <span class="n">next_node</span><span class="o">.</span><span class="n">find_next_sibling</span><span class="p">()</span>
        
        <span class="n">sections</span><span class="p">[</span><span class="n">combined_text</span><span class="p">]</span> <span class="o">=</span> <span class="n">section_content</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">sections</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">section_dict</span> <span class="o">=</span> <span class="n">extract_sections</span><span class="p">(</span><span class="n">doc_10k</span><span class="p">)</span>
<span class="n">sections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">section_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Section Title&#39;</span><span class="p">,</span> <span class="s1">&#39;Content&#39;</span><span class="p">])</span>
<span class="n">sections_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Section Title</th>
      <th>Content</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Business</td>
      <td>ITEM 1. BUSINESS\nProposed Merger with General...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Risk Factors</td>
      <td>ITEM 1A. RISK FACTORS\nYou should carefully co...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Unresolved Staff Comments</td>
      <td>ITEM 1B. UNRESOLVED STAFF COMMENTS\nNone.\n\nI...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Properties</td>
      <td>ITEM 2. PROPERTIES\nThe following table sets f...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Legal Proceedings</td>
      <td>ITEM 3. LEGAL PROCEEDINGS\nWe are a party to a...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mine Safety Disclosures</td>
      <td>ITEM 4. MINE SAFETY DISCLOSURES\nNot applicabl...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Market for the Registrant’s Common Equity, Rel...</td>
      <td>ITEM 5. MARKET FOR THE REGISTRANT'S COMMON EQU...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Selected Financial Data</td>
      <td>ITEM 6. SELECTED FINANCIAL DATA\n\nThe followi...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Management’s Discussion and Analysis of Financ...</td>
      <td>ITEM 7. BLUE BUFFALO PET PRODUCTS, INC. MANAGE...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Quantitative and Qualitative Disclosures about...</td>
      <td>ITEM 7A. QUANTITATIVE AND QUALITATIVE DISCLOSU...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Financial Statements and Supplementary Data</td>
      <td>ITEM 8. FINANCIAL STATEMENTS AND SUPPLEMENTARY...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Changes in and Disagreements with Accountants ...</td>
      <td>ITEM 9. CHANGES IN AND DISAGREEMENTS WITH ACCO...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Controls and Procedures</td>
      <td>ITEM 9A. CONTROLS AND PROCEDURES\n\nDisclosure...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Other Information</td>
      <td>ITEM 9B. OTHER INFORMATION\n\nNone.\n\n\n92\n\...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Directors, Executive Officers and Corporate Go...</td>
      <td>ITEM 10. DIRECTORS, EXECUTIVE OFFICERS AND COR...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Executive Compensation</td>
      <td>ITEM 11. EXECUTIVE COMPENSATION\nThe informati...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Security Ownership of Certain Beneficial Owner...</td>
      <td>ITEM 12. SECURITY OWNERSHIP OF CERTAIN BENEFIC...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Certain Relationships and Related Transactions...</td>
      <td>ITEM 13. CERTAIN RELATIONSHIPS AND RELATED TRA...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Principal Accounting Fees and Services</td>
      <td>ITEM 14. PRINCIPAL ACCOUNTING FEES AND SERVICE...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Exhibits and Financial Statement Schedules</td>
      <td>ITEM 15. EXHIBITS AND FINANCIAL STATEMENT SCHE...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Form 10-K Summary</td>
      <td>ITEM 16. FORM 10-K SUMMARY\n\nNone.\n\n97\n\n\...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Example of output</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sections_df</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluation">
<h2>3. Evaluation<a class="headerlink" href="#evaluation" title="Link to this heading">#</a></h2>
<p>Importing company names from database</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.parse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ast</span><span class="w"> </span><span class="kn">import</span> <span class="n">literal_eval</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/Users/SFL/Documents/1 Learn/UBC/Capstone/credentials.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">login</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    
<span class="n">username</span> <span class="o">=</span> <span class="n">login</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">login</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">login</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">login</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;postgresql://</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s1">@</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s1">/postgres&#39;</span><span class="p">)</span>

<span class="n">orgs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SELECT DISTINCT organization</span>
<span class="sd">    FROM rocketbrew_0424.address_book_supplement</span>
<span class="sd">    WHERE organization_name &lt;&gt; &#39;NONE&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">conn</span>
    <span class="p">)[</span><span class="s2">&quot;organization&quot;</span><span class="p">]</span>

<span class="n">orgs</span> <span class="o">=</span> <span class="p">[</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">org</span><span class="p">)</span> <span class="k">for</span> <span class="n">org</span> <span class="ow">in</span> <span class="n">orgs</span><span class="p">]</span>

<span class="n">company_urls</span> <span class="o">=</span> <span class="p">[(</span><span class="n">org</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="n">org</span><span class="p">[</span><span class="s2">&quot;website_url&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">org</span> <span class="ow">in</span> <span class="n">orgs</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">company_urls</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">,</span><span class="s2">&quot;urls&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>urls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Radius Health, Inc.</td>
      <td>http://www.radiuspharm.com</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GSK</td>
      <td>http://www.gskbio.com</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Echoworx</td>
      <td>http://www.echoworx.com</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Boyd Gaming</td>
      <td>http://www.boydgaming.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Blue Sky Network</td>
      <td>http://www.blueskynetwork.com</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14323</th>
      <td>Optum</td>
      <td>http://www.optum.com</td>
    </tr>
    <tr>
      <th>14324</th>
      <td>Integrity Marketing Group LLC</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14325</th>
      <td>Lecsor Inc</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14326</th>
      <td>Maple City Country Club</td>
      <td>http://www.maplecitycc.com</td>
    </tr>
    <tr>
      <th>14327</th>
      <td>Code Laboratories, Inc.</td>
      <td>http://www.codelaboratories.com</td>
    </tr>
  </tbody>
</table>
<p>14328 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/SFL/Documents/1 Learn/UBC/Capstone/data/training_urls.csv&#39;</span><span class="p">)</span>
<span class="n">url_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">]</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">url_df</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">train_names</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">train_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">train_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_cik_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">train_names</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">get_cik_url</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">all_cik_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 3294/3294 [12:52&lt;00:00,  4.27it/s]  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valid_cik_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">all_cik_results</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_10k_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">valid_cik_results</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">get_10k_url</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">all_10k_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 956/956 [02:53&lt;00:00,  5.51it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valid_10k_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">all_10k_results</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Evaluating 10-K parsing algorithm</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parsed_10k</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">valid_10k_results</span><span class="p">):</span>
    <span class="n">html_content</span> <span class="o">=</span> <span class="n">get_10k_file</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">extract_sections</span><span class="p">(</span><span class="n">html_content</span><span class="p">)</span>
    <span class="n">parsed_10k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 187/187 [14:25&lt;00:00,  4.63s/it]
</pre></div>
</div>
</div>
</div>
<p>Visualizing Section Title Stats</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">section_counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">document</span><span class="p">)</span> <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">parsed_10k</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">section_counts</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">section_counts</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">section_counts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of Number of Section Titles per 10-K Document&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Sections&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">section_counts</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">section_counts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/574121aae7c9debb557c5a2385df31bd8ccd2e33c19849cc72f54e37ec510e7c.png" src="_images/574121aae7c9debb557c5a2385df31bd8ccd2e33c19849cc72f54e37ec510e7c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="n">all_titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">title</span> <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">parsed_10k</span> <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="n">title_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">all_titles</span><span class="p">)</span>
<span class="n">top_titles</span> <span class="o">=</span> <span class="n">title_counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">top_titles_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">title</span> <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">top_titles</span><span class="p">]</span>
<span class="n">total_documents</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">parsed_10k</span> <span class="k">if</span> <span class="n">d</span><span class="p">])</span>
<span class="n">top_titles_percentages</span> <span class="o">=</span> <span class="p">[(</span><span class="n">title</span><span class="p">,</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total_documents</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">top_titles</span><span class="p">]</span>

<span class="n">titles</span><span class="p">,</span> <span class="n">percentages</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">top_titles_percentages</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span> <span class="n">percentages</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Percentage of Documents (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Section Titles&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top Section Titles in 10-K Documents&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">top_titles_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fe8a8bbf115b3cb13cbf8f2f0ec8ff6161ef7a383190f28b30b5ad9d71a08d2e.png" src="_images/fe8a8bbf115b3cb13cbf8f2f0ec8ff6161ef7a383190f28b30b5ad9d71a08d2e.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Legal Proceedings&#39;,
 &#39;Controls and Procedures&#39;,
 &#39;Risk Factors&#39;,
 &#39;Other Information&#39;,
 &#39;Business&#39;,
 &#39;Unresolved Staff Comments&#39;,
 &#39;Properties&#39;,
 &#39;Executive Compensation&#39;,
 &#39;Financial Statements and Supplementary Data&#39;,
 &#39;Mine Safety Disclosures&#39;,
 &#39;Directors, Executive Officers and Corporate Governance&#39;,
 &#39;Security Ownership of Certain Beneficial Owners and Management and Related Stockholder Matters&#39;,
 &#39;Certain Relationships and Related Transactions, and Director Independence&#39;,
 &#39;Form 10-K Summary&#39;,
 &#39;Management’s Discussion and Analysis of Financial Condition and Results of Operations&#39;,
 &#39;Quantitative and Qualitative Disclosures About Market Risk&#39;,
 &#39;Changes in and Disagreements with Accountants on Accounting and Financial Disclosure&#39;,
 &#39;Market for Registrant’s Common Equity, Related Stockholder Matters and Issuer Purchases of Equity Securities&#39;,
 &#39;Disclosure Regarding Foreign Jurisdictions that Prevent Inspections&#39;,
 &#39;Cybersecurity&#39;,
 &#39;Principal Accountant Fees and Services&#39;,
 &#39;Exhibits and Financial Statement Schedules&#39;,
 &#39;[Reserved]&#39;,
 &#39;Principal Accounting Fees and Services&#39;,
 &#39;Exhibits, Financial Statement Schedules&#39;,
 &#39;Quantitative and Qualitative Disclosures about Market Risk&#39;,
 &#39;Reserved&#39;,
 &#39;Changes in and Disagreements With Accountants on Accounting and Financial Disclosure&#39;,
 &#39;Selected Financial Data&#39;,
 &quot;Management&#39;s Discussion and Analysis of Financial Condition and Results of Operations&quot;,
 &quot;Market for Registrant&#39;s Common Equity, Related Stockholder Matters and Issuer Purchases of Equity Securities&quot;,
 &#39;Certain Relationships and Related Transactions and Director Independence&#39;,
 &#39;Exhibit and Financial Statement Schedules&#39;,
 &#39;Notes to Consolidated Financial Statements&#39;,
 &#39;Competition&#39;,
 &#39;Exhibit Index&#39;,
 &#39;C.Cybersecurity&#39;,
 &#39;Consolidated Statements of Cash Flows&#39;,
 &#39;Consolidated Balance Sheets&#39;,
 &#39;Report of Independent Registered Public Accounting Firm&#39;,
 &#39;General&#39;,
 &#39;Overview&#39;,
 &#39;EXHIBIT INDEX&#39;,
 &#39;Disclosure Regarding Foreign Jurisdictions That Prevent Inspections&#39;,
 &#39;Information about our Executive Officers&#39;,
 &#39;Forward-Looking Statements&#39;,
 &#39;Intellectual Property&#39;,
 &#39;Available Information&#39;,
 &#39;Business.&#39;,
 &#39;Unresolved Staff Comments.&#39;]
</pre></div>
</div>
</div>
</div>
<p>Compiling all data into dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cik</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Company Name&#39;</span><span class="p">:</span> <span class="n">train_names</span><span class="p">,</span>
    <span class="s1">&#39;CIK URL&#39;</span><span class="p">:</span> <span class="n">all_cik_results</span>
<span class="p">})</span>
<span class="n">df_10k</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;CIK URL&#39;</span><span class="p">:</span> <span class="n">valid_cik_results</span><span class="p">,</span>
    <span class="s1">&#39;10K URL&#39;</span><span class="p">:</span> <span class="n">all_10k_results</span>
<span class="p">})</span>
<span class="n">df_inital</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_cik</span><span class="p">,</span> <span class="n">df_10k</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;CIK URL&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">df_sections</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;10K URL&#39;</span><span class="p">:</span> <span class="n">valid_10k_results</span><span class="p">,</span>
    <span class="s1">&#39;Content&#39;</span><span class="p">:</span> <span class="n">parsed_10k</span>
<span class="p">})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_inital</span><span class="p">,</span> <span class="n">df_sections</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;10K URL&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Company Name&#39;</span><span class="p">,</span> <span class="s1">&#39;CIK URL&#39;</span><span class="p">,</span> <span class="s1">&#39;10K URL&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Statistics of Evaluation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_all</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">count_cik</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CIK URL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">count_10k</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;10K URL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">count_sections</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">count_all</span><span class="p">,</span> <span class="n">count_cik</span><span class="p">,</span> <span class="n">count_10k</span><span class="p">,</span> <span class="n">count_sections</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test Size: </span><span class="si">{</span><span class="n">count_all</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CIK Count: </span><span class="si">{</span><span class="n">count_cik</span><span class="si">}</span><span class="s2">, Among All: </span><span class="si">{</span><span class="n">count_cik</span><span class="o">/</span><span class="n">count_all</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10K Count: </span><span class="si">{</span><span class="n">count_10k</span><span class="si">}</span><span class="s2">,  Among All: </span><span class="si">{</span><span class="n">count_10k</span><span class="o">/</span><span class="n">count_all</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Section&gt;0: </span><span class="si">{</span><span class="n">count_sections</span><span class="si">}</span><span class="s2">,  Among 10K: </span><span class="si">{</span><span class="n">count_sections</span><span class="o">/</span><span class="n">count_10k</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test Size: 3294
CIK Count: 956, Among All: 0.290
10K Count: 187,  Among All: 0.057
Section&gt;0: 144,  Among 10K: 0.770
</pre></div>
</div>
</div>
</div>
<p>Exporting sample result data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">20</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">35</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Company Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Content&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/Users/SFL/Documents/1 Learn/UBC/Capstone/sample_10k_data.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Error analysis</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)][</span><span class="s1">&#39;10K URL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;10K URL&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="post-processing-of-sections">
<h3>Post-Processing of sections<a class="headerlink" href="#post-processing-of-sections" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of essential sections</span>
<span class="n">essential_sections</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Business&#39;</span><span class="p">,</span> <span class="s1">&#39;Risk Factors&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantitative and Qualitative Disclosures About Market Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;Properties&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Legal Proceedings&#39;</span><span class="p">,</span> <span class="s1">&#39;Controls and Procedures&#39;</span><span class="p">,</span> <span class="s1">&#39;Financial Statements and Supplementary Data&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Executive Compensation&#39;</span><span class="p">,</span> <span class="s1">&#39;Directors, Executive Officers and Corporate Governance&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Security Ownership of Certain Beneficial Owners and Management and Related Stockholder Matters&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Management’s Discussion and Analysis of Financial Condition and Results of Operations&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Market for Registrant’s Common Equity, Related Stockholder Matters and Issuer Purchases of Equity Securities&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Cybersecurity&#39;</span><span class="p">,</span> <span class="s1">&#39;Selected Financial Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Competition&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Certain Relationships and Related Transactions, and Director Independence&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Changes in and Disagreements with Accountants on Accounting and Financial Disclosure&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Disclosure Regarding Foreign Jurisdictions that Prevent Inspections&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Principal Accountant Fees and Services&#39;</span><span class="p">,</span> <span class="s1">&#39;Exhibits and Financial Statement Schedules&#39;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Fuzzy similarity matching</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fuzzywuzzy</span><span class="w"> </span><span class="kn">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">fuzz</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_best_match</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">choices</span><span class="p">):</span>
    <span class="n">best_match</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">extractOne</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">choices</span><span class="p">,</span> <span class="n">scorer</span><span class="o">=</span><span class="n">fuzz</span><span class="o">.</span><span class="n">ratio</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">best_match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>  <span class="c1"># Only consider it a match if the score is 80 or higher</span>
        <span class="k">return</span> <span class="n">best_match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># Function to restructure the content with fuzzy matching</span>
<span class="k">def</span><span class="w"> </span><span class="nf">restructure_content</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">structured_content</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">find_best_match</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">essential_sections</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">structured_content</span><span class="p">[</span><span class="n">match</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">structured_content</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">restructure_content</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="p">{}</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Applied processor reduces input query to empty string, all comparisons will have score 0. [Query: &#39;.&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Business&#39;: &#39;&#39;,
 &#39;Risk Factors&#39;: &#39;&#39;,
 &#39;Cybersecurity&#39;: &#39;&#39;,
 &#39;Properties&#39;: &#39;&#39;,
 &#39;Legal Proceedings&#39;: &#39;&#39;,
 &#39;Market for Registrant’s Common Equity, Related Stockholder Matters and Issuer Purchases of Equity Securities&#39;: &#39;&#39;,
 &#39;Management’s Discussion and Analysis of Financial Condition and Results of Operations&#39;: &#39;&#39;,
 &#39;Quantitative and Qualitative Disclosures About Market Risk&#39;: &#39;&#39;,
 &#39;Financial Statements and Supplementary Data&#39;: &#39;&#39;,
 &#39;Changes in and Disagreements with Accountants on Accounting and Financial Disclosure&#39;: &#39;&#39;,
 &#39;Controls and Procedures&#39;: &#39;&#39;,
 &#39;Disclosure Regarding Foreign Jurisdictions that Prevent Inspections&#39;: &#39;&#39;,
 &#39;Directors, Executive Officers and Corporate Governance&#39;: &#39;&#39;,
 &#39;Executive Compensation&#39;: &#39;&#39;,
 &#39;Security Ownership of Certain Beneficial Owners and Management and Related Stockholder Matters&#39;: &#39;&#39;,
 &#39;Certain Relationships and Related Transactions, and Director Independence&#39;: &#39;&#39;,
 &#39;Principal Accountant Fees and Services&#39;: &#39;&#39;,
 &#39;Exhibits and Financial Statement Schedules&#39;: &#39;&#39;}
</pre></div>
</div>
</div>
</div>
<p>Visualizing post-processing stats</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">title</span> <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="n">title_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">all_titles</span><span class="p">)</span>
<span class="n">top_titles</span> <span class="o">=</span> <span class="n">title_counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">total_documents</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Structured&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="n">top_titles_percentages</span> <span class="o">=</span> <span class="p">[(</span><span class="n">title</span><span class="p">,</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total_documents</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">top_titles</span><span class="p">]</span>
<span class="n">titles</span><span class="p">,</span> <span class="n">percentages</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">top_titles_percentages</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span> <span class="n">percentages</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Percentage of Documents (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Section Titles&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top Section Titles in 10-K Documents&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d63dac4f2381bde50f8e8c303404a5fb709c243311741b71f7a7fff6e6582df4.png" src="_images/d63dac4f2381bde50f8e8c303404a5fb709c243311741b71f7a7fff6e6582df4.png" />
</div>
</div>
</section>
</section>
<section id="experimenting-with-llm">
<h2>Experimenting with LLM<a class="headerlink" href="#experimenting-with-llm" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">meta_ai_api</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetaAI</span>
<span class="n">ai</span> <span class="o">=</span> <span class="n">MetaAI</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">link</span> <span class="o">=</span> <span class="s1">&#39;https://www.sec.gov/Archives/edgar/data/778972/000143774914003821/fbmi20131231_10k.htm&#39;</span>

<span class="n">ai</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s2"> Search the text of the 10-K filing for the &#39;Risk Factors&#39; item and provide its content; if not found, return &#39;None&#39;.&quot;</span><span class="p">)[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Risk Factors\nThe risks and uncertainties described below are not the only ones we face. Additional risks and uncertainties not presently known to us or that we currently deem immaterial may also impair our business operations. If any of the following risks occur, our business, financial condition, and results of operations could be materially harmed.\nRisks Related to Our Business\nWe may not be able to sustain our revenue growth rate.\nWe may not be able to maintain our profitability.\nWe may not be able to compete effectively in the highly competitive markets in which we operate.\nWe may not be able to continue to develop and launch new and innovative products and services.\nWe may not be able to maintain our brand and reputation.\nWe may not be able to attract and retain skilled employees.\nWe may not be able to manage our growth effectively.\nWe may not be able to maintain our global operations effectively.\nWe may not be able to comply with increasingly complex and changing laws and regulations.\nWe may be subject to legal proceedings and regulatory actions.\nWe may not be able to maintain our intellectual property rights.\nWe may be subject to security breaches and cyber attacks.\nWe may not be able to manage our relationships with third-party vendors and suppliers.\nWe may not be able to maintain our information technology systems and infrastructure.\nWe may be subject to disruptions in the global economy and financial markets.\nWe may not be able to maintain our credit rating.\nWe may be subject to interest rate risks.\nWe may be subject to foreign exchange risks.\nWe may be subject to other risks related to our international operations.\nRisks Related to Our Financial Condition\nWe have a significant amount of debt and may not be able to meet our debt obligations.\nWe may not be able to generate sufficient cash to fund our operations and capital expenditures.\nWe may not be able to access the capital markets on favorable terms.\nWe may be subject to covenants and restrictions in our debt agreements.\nRisks Related to Our Industry\nWe operate in a highly competitive market and may not be able to compete effectively.\nWe may not be able to adapt to changes in the market for online and mobile advertising.\nWe may not be able to adapt to changes in the market for online and mobile commerce.\nWe may not be able to adapt to changes in the market for digital payments.\nWe may not be able to adapt to changes in the market for artificial intelligence and machine learning.\nPlease note that this is a summary of the Risk Factors section of the 10-K filing and is not intended to be a comprehensive or exhaustive list of all the risks and uncertainties facing Facebook, Inc. (now known as Meta Platforms, Inc.).\n&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_result</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">essential_sections</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">ai</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s2"> Search the text of the 10-K filing for the &#39;</span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">&#39; item and provide its content; if not found, return &#39;None&#39;.&quot;</span><span class="p">)[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
    <span class="n">test_result</span><span class="p">[</span><span class="n">section</span><span class="p">]</span> <span class="o">=</span> <span class="n">content</span>
<span class="n">test_result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 20/20 [05:14&lt;00:00, 15.73s/it]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Business&#39;: &quot;The &#39;Business&#39; item from the 10-K filing is:\nItem 1. Business.\nMeta Platforms, Inc., (“Facebook” or the “Company”) is a technology company that is headquartered in Menlo Park, California. We are a global community of people who use Facebook, Instagram, WhatsApp, or each of their respective family of products. Our products empower people to connect, share, discover, and communicate with each other on mobile devices and personal computers. We have the following reportable segments:\nAdvertising (Facebook and Instagram)\nPayment Processing Fees (Facebook and WhatsApp)\nConsumer Hardware (Oculus)\nOther (Oculus and other products)\nWe had 2.50 billion monthly active users (MAUs) as of December 31, 2013.\nNone of the information contained in this filing constitutes an offer to sell or a solicitation of an offer to buy any securities of the Company.\nLet me know if you need any further assistance!\n&quot;,
 &#39;Risk Factors&#39;: &quot;Risk Factors\nThe following are some of the key factors that could affect our business, financial condition, and results of operations:\nGeneral Economic and Industry Conditions: Economic downturns, industry downturns, or changes in market conditions could hurt our business.\nCompetition: We face intense competition in the market, which could hurt our business.\nRegulatory Risks: Changes in laws, regulations, or policies could hurt our business.\nUser Engagement: If our users lose interest in our platform, our business could suffer.\nData Privacy and Security: If we fail to protect our users&#39; data, our business could suffer.\nDependence on Key Personnel: Our business is dependent on our key personnel, and the loss of any of them could hurt our business.\nIntellectual Property Risks: If we are unable to protect our intellectual property, our business could suffer.\nLitigation Risks: We are subject to various legal proceedings, which could hurt our business.\nGlobal Expansion Risks: Our international expansion may not be successful.\nCurrency Fluctuations: Changes in currency exchange rates could hurt our business.\nDependence on Third-Party Services: We rely on third-party services, and if they are not available, our business could suffer.\nPlease note that these are just some of the risk factors, and the actual filing may contain additional or different risks.\n&quot;,
 &#39;Quantitative and Qualitative Disclosures About Market Risk&#39;: &#39;Quantitative and Qualitative Disclosures About Market Risk\nThe following information is from Item 7A of the 10-K filing:\nMarket Risk\nWe are exposed to market risk related to changes in interest rates, foreign currency exchange rates, and equity and commodity prices.\nInterest Rate Risk\nOur exposure to interest rate risk relates primarily to our investment portfolio. We manage our exposure to interest rate risk through our investment strategy and by maintaining a diversified investment portfolio.\nForeign Currency Exchange Risk\nWe have international operations and are exposed to foreign currency exchange risk related to changes in exchange rates between the U.S. dollar and other currencies. We manage our exposure to foreign currency exchange risk through our hedging strategy.\nEquity Price Risk\nOur exposure to equity price risk relates primarily to our investments in privately held companies. We manage our exposure to equity price risk through our investment strategy and by maintaining a diversified investment portfolio.\nCommodity Price Risk\nWe are not directly exposed to commodity price risk, as we do not engage in commodity-based transactions.\nPlease note that this is a summary of the relevant section and not the full content of the 10-K filing.\n&#39;,
 &#39;Properties&#39;: &#39;Properties\nWe lease our principal properties, including our headquarters, in Menlo Park, California. We also lease properties in various other locations in the United States and abroad for our engineering teams, data centers, and offices for our sales and operations teams.\nAs of December 31, 2013, we had:\n1.08 million square feet of leased space in Menlo Park, California, which primarily supports our headquarters and engineering teams;\n431,000 square feet of leased space in New York City, New York, which primarily supports our sales and operations teams;\n342,000 square feet of leased space in Seattle, Washington, which primarily supports our engineering teams;\n275,000 square feet of leased space in San Francisco, California, which primarily supports our engineering teams;\n236,000 square feet of leased space in Los Angeles, California, which primarily supports our sales and operations teams;\n174,000 square feet of leased space in London, United Kingdom, which primarily supports our sales and operations teams;\n163,000 square feet of leased space in Dublin, Ireland, which primarily supports our sales and operations teams;\n135,000 square feet of leased space in Palo Alto, California, which primarily supports our engineering teams;\n103,000 square feet of leased space in Austin, Texas, which primarily supports our sales and operations teams; and\n85,000 square feet of leased space in Tel Aviv, Israel, which primarily supports our engineering teams.\nWe believe our facilities are sufficient for our current needs and do not anticipate any difficulties in obtaining additional space as needed.\n&#39;,
 &#39;Legal Proceedings&#39;: &quot;Legal Proceedings\nFrom time to time, we are involved in legal proceedings and claims that arise in the ordinary course of our business. These proceedings and claims may relate to a wide range of matters, including intellectual property, advertising, consumer protection, data privacy, employment, and commercial disputes.\nWe are currently involved in several legal proceedings, including the following:\nIn re Facebook, Inc. Securities Litigation: In July 2012, a putative class action lawsuit was filed against us in the United States District Court for the Southern District of New York. The lawsuit alleges that our IPO prospectus and Registration Statement contained false and misleading statements regarding our financial condition and prospects. We believe these claims are without merit and intend to vigorously defend ourselves.\nYahoo! Inc. v. Facebook, Inc.: In November 2012, Yahoo! Inc. filed a lawsuit against us in the United States District Court for the Northern District of California. The lawsuit alleges that we infringe on certain Yahoo! patents related to online advertising and website customization. We believe these claims are without merit and intend to vigorously defend ourselves.\nRemijas v. Facebook, Inc.: In August 2013, a putative class action lawsuit was filed against us in the United States District Court for the Northern District of California. The lawsuit alleges that our practice of scanning the content of private messages for advertising purposes violates the Electronic Communications Privacy Act and California&#39;s Invasion of Privacy Act. We believe these claims are without merit and intend to vigorously defend ourselves.\nWe are also subject to various other legal proceedings and claims that arise in the ordinary course of our business. We may incur significant legal expenses in connection with these proceedings, and we may be required to pay significant damages or settlement amounts if we are unsuccessful in our defense.\nPlease note that the text is a snapshot of the company&#39;s legal proceedings as of December 31, 2013, and may not reflect the current status of these cases.\n&quot;,
 &#39;Controls and Procedures&#39;: &#39;Controls and Procedures\nAs of December 31, 2013, our management, with the participation of our Chief Executive Officer and Chief Financial Officer, evaluated the effectiveness of our disclosure controls and procedures (as defined in Rules 13a-15(e) and 15d-15(e) under the Securities Exchange Act of 1934). Based on this evaluation, our Chief Executive Officer and Chief Financial Officer concluded that as of December 31, 2013, our disclosure controls and procedures were effective.\nOur management is responsible for establishing and maintaining adequate internal control over financial reporting (as defined in Rules 13a-15(f) and 15d-15(f) under the Securities Exchange Act of 1934). Our management, with the participation of our Chief Executive Officer and Chief Financial Officer, evaluated the effectiveness of our internal control over financial reporting as of December 31, 2013. In making this assessment, our management used the criteria set forth by the Committee of Sponsoring Organizations of the Treadway Commission (COSO) in Internal Control—Integrated Framework (1992 framework).\nBased on this evaluation, our management, including our Chief Executive Officer and Chief Financial Officer, concluded that as of December 31, 2013, our internal control over financial reporting was effective.\n(Note: The text is extracted from the given URL, which is a 10-K filing for Facebook, Inc. for the year ended December 31, 2013)\n&#39;,
 &#39;Financial Statements and Supplementary Data&#39;: &quot;The &#39;Financial Statements and Supplementary Data&#39; section from the 10-K filing is:\nFinancial Statements and Supplementary Data\nFinancial Statements\nReport of Independent Registered Public Accounting Firm\nConsolidated Balance Sheets\nDecember 31, 2013 and 2012\nConsolidated Statements of Income\nYears ended December 31, 2013, 2012, and 2011\nConsolidated Statements of Comprehensive Income\nYears ended December 31, 2013, 2012, and 2011\nConsolidated Statements of Cash Flows\nYears ended December 31, 2013, 2012, and 2011\nNotes to Consolidated Financial Statements\nSupplementary Data\nQuarterly Financial Data (Unaudited)\nYears ended December 31, 2013 and 2012\nLet me know if you&#39;d like me to extract any specific information from this section!\n&quot;,
 &#39;Executive Compensation&#39;: &#39;The \&#39;Executive Compensation\&#39; section of the 10-K filing is:\nExecutive Compensation\nThe material in this report is not &quot;soliciting material,&quot; is not deemed &quot;filed&quot; with the Commission and is not to be incorporated by reference into any filing of the registrant under the Securities Act of 1933 or the Securities Exchange Act of 1934, whether made before or after the date hereof and irrespective of any general incorporation language in any such filing.\nCompensation Discussion and Analysis\nOur executive compensation program is designed to attract, retain and motivate our executives to achieve our business objectives and increase long-term stockholder value. Our program is based on a pay-for-performance philosophy, which means that a significant portion of our executives\&#39; compensation is tied to our performance.\nThe following compensation elements are provided to our named executive officers (NEOs):\nBase salary\nBonus\nEquity awards (restricted stock units (RSUs) and stock options)\nBenefits (health insurance, life insurance and disability insurance)\nOther benefits (such as use of company aircraft and security services)\nThe Compensation Committee of our Board of Directors (the Compensation Committee) is responsible for determining the compensation of our NEOs. The Compensation Committee works with its independent compensation consultant, Exequity LLP, to determine the appropriate compensation levels and mix of compensation elements for our NEOs.\nFor more information, see &quot;Compensation Committee Report&quot; and &quot;Executive Compensation Tables&quot; below.\nCompensation Committee Report\nThe Compensation Committee has reviewed and discussed the Compensation Discussion and Analysis with management, and based on such review and discussion, the Compensation Committee recommended to the Board of Directors that the Compensation Discussion and Analysis be included in this report.\nCompensation Committee\nMarc L. Andreessen\nErskine B. Bowles\nKenneth I. Chenault\nSusan D. Desmond-Hellmann\nMark J. Pincus\nExecutive Compensation Tables\nThe following tables set forth the compensation paid to our NEOs for the fiscal years ended December 31, 2013 and 2012.\nSummary Compensation Table\nName and Principal PositionYearSalaryBonusStock AwardsOption AwardsNon-Equity Incentive Plan CompensationChange in Pension Value and Nonqualified Deferred Compensation EarningsAll Other CompensationTotalMark Zuckerberg2013$1$266,859$3,989,965$$$$1,278,846$6,536,6702012$1$266,859$2,279,973$$$$1,016,167$3,563,999Sheryl K. Sandberg2013$333,333$$13,951,155$$$$1,278,846$15,563,3342012$321,927$$6,878,993$$$$1,016,167$8,216,087Michael W. Schroepfer2013$263,333$$2,599,996$$$$651,155$3,514,4842012$249,167$$1,599,996$$$$543,182$2,392,345David M. Wehner2013$175,000$$1,399,996$$$$431,155$2,005,1512012$150,000$$1,099,996$$$$343,182$1,592,178Christopher Cox2013$175,000$$1,399,996$$$$431,155$2,005,1512012$150,000$$1,099,996$$$$343,182$1,592,178\nLet me know if you have any further questions!\n&#39;,
 &#39;Directors, Executive Officers and Corporate Governance&#39;: &#39;Here is the content of the &quot;Directors, Executive Officers and Corporate Governance&quot; section from the 10-K filing:\nDirectors, Executive Officers and Corporate Governance\nDirectors\nOur board of directors consists of eight members, including:\nMark Zuckerberg — Chairman of the Board of Directors and Chief Executive Officer\nSheryl Sandberg — Chief Operating Officer and Director\nMarc L. Andreessen — Director\nErskine B. Bowles — Director\nJames W. Breyer — Director\nDonald E. Graham — Director\nReed Hastings — Director\nPeter A. Thiel — Director\nExecutive Officers\nThe following individuals serve as our executive officers:\nMark Zuckerberg — Chairman of the Board of Directors and Chief Executive Officer\nSheryl Sandberg — Chief Operating Officer\nDavid M. Wehner — Chief Financial Officer\nMike Schroepfer — Chief Technology Officer\nChristopher Cox — Chief Product Officer\nCorporate Governance\nOur board of directors has established an audit committee, a compensation committee, and a nominating and governance committee. Our audit committee consists of Messrs. Breyer, Graham, and Thiel. Our compensation committee consists of Messrs. Andreessen, Bowles, and Hastings. Our nominating and governance committee consists of Messrs. Andreessen, Breyer, and Sandberg.\nLet me know if you have any further questions!\n&#39;,
 &#39;Security Ownership of Certain Beneficial Owners and Management and Related Stockholder Matters&#39;: &quot;Security Ownership of Certain Beneficial Owners and Management and Related Stockholder Matters\nThe following table sets forth information regarding the beneficial ownership of our common stock as of December 31, 2013, by:\neach person or group of persons known by us to beneficially own more than 5% of our outstanding common stock;\neach of our directors;\neach of our executive officers; and\nall of our directors and executive officers as a group.\nName of Beneficial OwnerNumber of SharesPercentage of Outstanding SharesThe Vanguard Group, Inc.42,347,4125.3%BlackRock, Inc.34,762,1144.4%State Street Corporation29,704,6613.8%FMR, LLC (Fidelity)23,517,1123.0%Mark Zuckerberg426,274,79453.3%Sheryl K. Sandberg4,477,0220.6%David Wehner1,294,6540.2%Mike Schroepfer1,253,3340.2%David Ebersman1,242,1140.2%Donald E. Graham1,104,4260.1%Robert K. Kagle1,043,6690.1%Reed Hastings945,5620.1%Erskine B. Bowles844,1630.1%Susan D. Desmond-Hellmann744,1630.1%All directors and executive officers as a group (14 persons)433,342,52854.4%\nNote: The percentages are based on 793,655,205 shares of common stock outstanding as of December 31, 2013.\nPlease note that this information may not be up to date, and the filing is from 2013. If you need more recent information, please let me know, and I&#39;ll do my best to assist you.\n&quot;,
 &#39;Management’s Discussion and Analysis of Financial Condition and Results of Operations&#39;: &#39;The \&#39;Management’s Discussion and Analysis of Financial Condition and Results of Operations\&#39; section from the given 10-K filing is reproduced below:\nManagement\&#39;s Discussion and Analysis of Financial Condition and Results of Operations\nOur management\&#39;s discussion and analysis of financial condition and results of operations (&quot;MD&amp;A&quot;) is provided in addition to, and should be read in conjunction with, our consolidated financial statements and related notes. Our MD&amp;A includes the following sections:\nOverview: A summary of our business and significant trends and events that affect our financial condition and results of operations.\nResults of Operations: An analysis of our financial performance for the year ended December 31, 2013, compared to the year ended December 31, 2012.\nFinancial Condition: A discussion of our financial position as of December 31, 2013, compared to December 31, 2012.\nLiquidity and Capital Resources: A discussion of our liquidity and capital resources as of December 31, 2013.\nOff-Balance-Sheet Arrangements: A discussion of our off-balance-sheet arrangements as of December 31, 2013.\nContractual Obligations: A discussion of our contractual obligations as of December 31, 2013.\nCritical Accounting Standards and Estimates: A discussion of our critical accounting standards and estimates.\nRecently Adopted Accounting Pronouncements: A discussion of recently adopted accounting pronouncements.\nRecent Accounting Pronouncements Not Yet Adopted: A discussion of recent accounting pronouncements not yet adopted.\nPlease note that I\&#39;ve extracted the content of this section as per your request. However, I recommend reading the entire 10-K filing to get a comprehensive understanding of the company\&#39;s financial condition and results of operations.\nLet me know if you have any further questions or if there\&#39;s anything else I can assist you with!\n&#39;,
 &#39;Market for Registrant’s Common Equity, Related Stockholder Matters and Issuer Purchases of Equity Securities&#39;: &quot;The requested text is quite long, but I&#39;ve extracted the relevant section for you:\nMarket for Registrant’s Common Equity, Related Stockholder Matters and Issuer Purchases of Equity Securities\nOur Class A common stock is listed on the NASDAQ Global Select Market under the ticker symbol “FB”. The following table sets forth the high and low sales prices of our Class A common stock as reported on the NASDAQ Global Select Market for each quarter in the years ended December 31, 2013 and 2012:\nQuarterHighLow2013 QuartersFirst Quarter31.4522.67Second Quarter39.2924.88Third Quarter49.6636.87Fourth Quarter57.9745.182012 QuartersFirst Quarter43.9529.52Second Quarter41.3425.87Third Quarter33.0517.55Fourth Quarter31.4518.87\nAs of February 14, 2014, there were 4,299 holders of record of our Class A common stock and 1,043 holders of record of our Class B common stock.\nStock Performance Graph\nThe following graph shows the total return of an investment in our Class A common stock, the NASDAQ Composite Index, and the S&amp;P 500 Index for the period from January 1, 2010 through December 31, 2013.\n[Insert Graphic]\nIssuer Purchases of Equity Securities\nWe did not purchase any of our equity securities during the year ended December 31, 2013.\nLet me know if you&#39;d like me to extract any specific data points from this section!\n&quot;,
 &#39;Cybersecurity&#39;: &#39;The text of the 10-K filing is not directly accessible to me. However, I can suggest ways for you to search the content yourself.\nYou can copy and paste the text into a word processor or text editor and search for &quot;Cybersecurity&quot;. Alternatively, you can use the Find function (Ctrl + F) in your web browser to search the text.\nIf you provide the text, I can assist you in finding the specific section or content related to Cybersecurity.\n&#39;,
 &#39;Selected Financial Data&#39;: &quot;Selected Financial Data\nWe have audited the accompanying consolidated balance sheets of Facebook, Inc. as of December 31, 2013 and 2012, and the related consolidated statements of income, comprehensive income, and cash flows for each of the three years in the period ended December 31, 2013. Our audits also included the financial statement schedule listed in the Index at Item 15. We did not audit the financial statements of Facebook&#39;s subsidiaries, which statements reflect total assets of $5,443,215 and $3,534,292 as of December 31, 2013 and 2012, respectively, and total revenues of $3,771,572 and $2,415,306 for the years ended December 31, 2013 and 2012, respectively.\nSelected Financial Data\nThe following selected financial data is derived from our audited consolidated financial statements.\nYears Ended December 31,\n2013   * 2012   * 2011   * 2010   * 2009\n----   * ----   * ----   * ----   * ----\nRevenue   * $7,872   * $5,089   * $3,711   * $2,000   * $777\nNet income (loss)   *  $1,000   * $(696)   * $(564)\nNet income (loss) per share - diluted   *  $0.46   * $(0.29)   * $(0.29)\nTotal assets   * $18,435   * $9,446   * $6,313   * $3,446   * $1,632\nLong-term debt   * $1,500   * $ -   * $ -   * $ -   * $ -\nLet me know if you have any further requests!\n&quot;,
 &#39;Competition&#39;: &#39;The content of the &quot;Competition&quot; item from the 10-K filing is:\nCompetition\nWe compete in the global online advertising and technology industries, which are highly competitive and rapidly evolving. We face significant competition in all areas of our business, including:\nOnline advertising: We compete with other companies that offer online advertising services, including Google, Microsoft, and Yahoo!.\nUser engagement: We compete with other companies that offer online services and products that compete for user attention and engagement, including other social media platforms, online search engines, and online entertainment providers.\nMobile: We compete with other companies that offer mobile apps and services that compete for user attention and engagement, including other social media platforms, mobile operating systems, and mobile apps.\nE-commerce: We compete with other companies that offer e-commerce services and products that compete for user attention and engagement, including other e-commerce platforms, online marketplaces, and brick-and-mortar retailers.\nSource: [1]\nPlease note that the text is extracted from a specific section of the filing and might not be comprehensive.\n&#39;,
 &#39;Certain Relationships and Related Transactions, and Director Independence&#39;: &#39;The content of the &quot;Certain Relationships and Related Transactions, and Director Independence&quot; item from the 10-K filing is:\nCertain Relationships and Related Transactions, and Director Independence\nOur code of conduct and our Board of Directors are responsible for reviewing and approving transactions between us and any related parties. A related party is any person or entity that has a relationship with us that could influence the terms or manner of a transaction. Related parties include our directors, executive officers, nominees for election as directors, and their immediate family members.\nDuring 2013, there were no transactions with related parties that are required to be disclosed under the rules and regulations of the Securities and Exchange Commission.\nOur Board of Directors has determined that all of our directors, other than Mark Zuckerberg, are independent directors, as defined in the rules of the NASDAQ Stock Market. Our independent directors are: Marc Andreessen, Erskine Bowles, Kenneth Chenault, Susan Desmond-Hellmann, Donald Graham, Reed Hastings, Peter Thiel, and Jeffrey Zients.\nNote: The content has been extracted from the specified section of the 10-K filing and is presented in its original format, with minimal formatting adjustments for readability.\nPlease let me know if you have any further questions or requests!\n&#39;,
 &#39;Changes in and Disagreements with Accountants on Accounting and Financial Disclosure&#39;: &quot;Changes in and Disagreements with Accountants on Accounting and Financial Disclosure\nNone.\nNote: The text of the 10-K filing does not contain the specified item. According to the SEC&#39;s guidelines, this item is only required if there are any changes in accountants or disagreements with accountants, which is not the case in this filing.\n&quot;,
 &#39;Disclosure Regarding Foreign Jurisdictions that Prevent Inspections&#39;: &#39;Disclosure Regarding Foreign Jurisdictions that Prevent Inspections\nThe following is the content of the item:\n&quot;We are subject to the inspection requirements of the Public Company Accounting Oversight Board (PCAOB). Our independent registered public accounting firm, Ernst &amp; Young LLP, is subject to the PCAOB\&#39;s inspection requirements. To our knowledge, there are no legal or regulatory proceedings or settlements that would prevent our independent registered public accounting firm from being subject to the PCAOB\&#39;s inspection requirements.\nWe have been informed by our legal counsel in China that, based on the advice of the China Securities Regulatory Commission, the Chinese affiliates of the major accounting firms, including our independent registered public accounting firm, are not permitted to disclose to the PCAOB or any other foreign regulatory authority certain information regarding their audit work papers and other related documents. This could limit the PCAOB\&#39;s ability to conduct inspections of our independent registered public accounting firm and could result in the PCAOB determining that our independent registered public accounting firm is not in compliance with the PCAOB\&#39;s inspection requirements.\nIf the PCAOB determines that our independent registered public accounting firm is not in compliance with its inspection requirements, we could be subject to sanctions, including the inability to list our securities on a national securities exchange, which could adversely affect our business and the market price of our common stock.&quot;\nPlease note that the content is extracted from the provided URL and may not be up-to-date. The latest filings should be checked for the most recent information.\n&#39;,
 &#39;Principal Accountant Fees and Services&#39;: &#39;Principal Accountant Fees and Services\nThe following table presents the fees billed by Ernst &amp; Young LLP, our independent auditor, for the years ended December 31, 2013 and 2012:\nFees20132012Audit Fees$2,022,000$1,925,000Audit-Related Fees$30,000$30,000Tax Fees$135,000$130,000All Other Fees$0$0Total$2,187,000$2,085,000\nAudit Fees: These fees relate to the audit of our annual financial statements and the review of our quarterly financial statements.\nAudit-Related Fees: These fees relate to assurance and related services that are reasonably related to the performance of the audit or review of our financial statements.\nTax Fees: These fees relate to tax compliance, tax advice, and tax planning services.\nAll Other Fees: These fees relate to services other than those described above.\nSource: [Facebook, Inc. Form 10-K for the fiscal year ended December 31, 2013]((link unavailable))\n&#39;,
 &#39;Exhibits and Financial Statement Schedules&#39;: &quot;Here is the content of the &#39;Exhibits and Financial Statement Schedules&#39; item from the 10-K filing:\nExhibits and Financial Statement Schedules\n(a) Exhibits\nExhibit 2.1: Agreement and Plan of Merger, dated as of July 1, 2012, by and among Facebook, Inc., Facebook Merger Sub, Inc., Instagram, Inc., and Shareholders’ Representative (incorporated by reference to Exhibit 2.1 to Facebook’s Current Report on Form 8-K filed on April 23, 2012)\nExhibit 3.1: Amended and Restated Certificate of Incorporation of Facebook, Inc. (incorporated by reference to Exhibit 3.1 to Facebook’s Quarterly Report on Form 10-Q filed on July 31, 2013)\nExhibit 3.2: Amended and Restated Bylaws of Facebook, Inc. (incorporated by reference to Exhibit 3.2 to Facebook’s Quarterly Report on Form 10-Q filed on July 31, 2013)\nExhibit 4.1: Form of Common Stock Certificate (incorporated by reference to Exhibit 4.1 to Facebook’s Registration Statement on Form S-1 filed on February 1, 2012)\nExhibit 10.2: 2012 Director Stock Plan (incorporated by reference to Exhibit 10.2 to Facebook’s Registration Statement on Form S-1 filed on February 1, 2012)\nExhibit 10.3: 2012 Director Stock Plan, Form of Stock Option Agreement (incorporated by reference to Exhibit 10.3 to Facebook’s Registration Statement on Form S-1 filed on February 1, 2012)\nExhibit 10.4: 2012 Director Stock Plan, Form of Restricted Stock Unit Agreement (incorporated by reference to Exhibit 10.4 to Facebook’s Registration Statement on Form S-1 filed on February 1, 2012)\nExhibit 10.5: Facebook, Inc. 2013 Compensation and Talent Acquisition Plan (incorporated by reference to Exhibit 10.5 to Facebook’s Quarterly Report on Form 10-Q filed on July 31, 2013)\nExhibit 10.6: Facebook, Inc. 2013 Equity Incentive Plan (incorporated by reference to Exhibit 10.6 to Facebook’s Quarterly Report on Form 10-Q filed on July 31, 2013)\nExhibit 10.7: Facebook, Inc. 2013 Equity Incentive Plan, Form of Stock Option Agreement (incorporated by reference to Exhibit 10.7 to Facebook’s Quarterly Report on Form 10-Q filed on July 31, 2013)\nExhibit 10.8: Facebook, Inc. 2013 Equity Incentive Plan, Form of Restricted Stock Unit Agreement (incorporated by reference to Exhibit 10.8 to Facebook’s Quarterly Report on Form 10-Q filed on July 31, 2013)\nExhibit 21.1: Subsidiaries of Facebook, Inc.\nExhibit 23.1: Consent of Ernst &amp; Young LLP, Independent Registered Public Accounting Firm\nExhibit 31.1: Certification of Chief Executive Officer pursuant to Rule 13a-14(a) or Rule 15d-14(a) under the Securities Exchange Act of 1934\nExhibit 31.2: Certification of Chief Financial Officer pursuant to Rule 13a-14(a) or Rule 15d-14(a) under the Securities Exchange Act of 1934\nExhibit 32.1: Certification of Chief Executive Officer pursuant to Rule 13a-14(b) or Rule 15d-14(b) under the Securities Exchange Act of 1934 and 18 U.S.C. Section 1350\nExhibit 32.2: Certification of Chief Financial Officer pursuant to Rule 13a-14(b) or Rule 15d-14(b) under the Securities Exchange Act of 1934 and 18 U.S.C. Section 1350\nExhibit 101.INS: XBRL Instance Document\nExhibit 101.SCH: XBRL Taxonomy Extension Schema Document\nExhibit 101.CAL: XBRL Taxonomy Extension Calculation Linkbase Document\nExhibit 101.LAB: XBRL Taxonomy Extension Label Linkbase Document\nExhibit 101.PRE: XBRL Taxonomy Extension Presentation Linkbase Document\nExhibit 101.DEF: XBRL Taxonomy Extension Definition Linkbase Document\n(b) Financial Statement Schedules\nSchedule II: Valuation and Qualifying Accounts\nSchedule III: Real Estate Investments\nLet me know if you have any further requests!\n&quot;}
</pre></div>
</div>
</div>
</div>
<p>Testing message generation with <a class="reference external" href="http://Meta.ai">Meta.ai</a> API</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ai</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Use the the most prominent aspect of the below a reciever&#39;s information to generate a short first line that includes a greeting and affirmation/congratulation/compliment of their experience to be used for an intial linkedin personalized cold outreach message that hooks their attention, reply as if you are sending me that message, so only return the sentence itself and nothing else:</span>

<span class="s2">ITEM 1. BUSINESS</span>
<span class="s2">Proposed Merger with General Mills, Inc.</span>
<span class="s2">On February 22, 2018, Blue Buffalo Pet Products, Inc., General Mills, Inc., a Delaware corporation (“GMI”), and Bravo Merger Corp., a Delaware corporation and wholly-owned subsidiary of GMI (“Merger Sub”), entered into an Agreement and Plan of Merger (the “Merger Agreement”), pursuant to which, on the terms and subject to the conditions set forth in the Merger Agreement, GMI agreed to acquire the Company for $40.00 per common share, in cash.</span>
<span class="s2">On the terms and subject to the conditions set forth in the Merger Agreement, Merger Sub will merge with and into the Registrant (the “Merger”), with the Registrant continuing as the surviving company and as a wholly-owned subsidiary of GMI, and our common stock will be delisted from the NASDAQ Stock Market. At the effective time of the Merger, each share of our common stock (other than shares of the Company’s common stock held by GMI, Merger Sub or any other wholly-owned subsidiary of GMI, shares owned by the Company (including shares held in treasury) or any of its wholly-owned subsidiaries, and shares owned by stockholders who have properly exercised and perfected appraisal rights under Delaware law) will be converted into the right to receive $40.00 in cash per share.</span>
<span class="s2">The boards of directors of each of GMI and the Registrant have approved the Merger Agreement and holders of more than 50</span><span class="si">% o</span><span class="s2">f the Registrant’s outstanding shares have approved the transaction. While no other approval of the Registrant’s Board of Directors or shareholders is required to complete the transaction, the closing of the Merger is subject to certain regulatory approvals and other customary closing conditions.</span>
<span class="s2">There is no assurance that the Merger will occur. See “Risk Factors-Risks Related to the Pending Merger” in “Part I-Item 1A. Risk Factors.”</span>
<span class="s2">Overview</span>
<span class="s2">We are one of the fastest growing major pet food companies in the United States, selling dog and cat food made with whole meats, fruits and vegetables, and other high-quality, natural ingredients. BLUE is a billion dollar brand and is the #1 brand in the Wholesome Natural market segment. We currently have approximately 7</span><span class="si">% s</span><span class="s2">hare of the U.S. pet food market and feed only 3</span><span class="si">% o</span><span class="s2">f the 184 million pets in the United States. With a proven new user acquisition strategy, we are committed to converting more pet parents into True Blue Believers and continuing to increase our share of the attractive $28 billion U.S. pet food market.</span>
<span class="s2">We believe we have built an exceptional company with a breakthrough brand and an innovative business model, backed by our mission and our belief in a large unmet consumer demand for pet food with high-quality, natural ingredients.</span>
<span class="s2">Our History</span>
<span class="s2">Today, Blue Buffalo Pet Products, Inc. (“BBPP”, and together with its subsidiaries, the “Company,” “we,” “us,” “its,” and “our”) conducts its business exclusively through its wholly-owned operating</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Hi, I wanted to reach out and congratulate you on the impressive merger with General Mills, Inc. - quite an achievement!\n&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ai</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">https://www.sec.gov/Archives/edgar/data/1694426/000169442624000028/dk-20231231.htm#i6fa8754773d643bcbfbf1e33d05e1689_265</span>
<span class="s2">Read the above 10-K filing link, if there isn&#39;t a item called &#39;MARKET FOR REGISTRANT&#39;S COMMON EQUITY, RELATED STOCKHOLDER MATTERS AND ISSUER PURCHASES OF EQUITY SECURITIES&#39;, return &#39;None&quot; and nothing else; if there is, provide the above link&#39;s content of item &#39;MARKET FOR REGISTRANT&#39;S COMMON EQUITY, RELATED STOCKHOLDER MATTERS AND ISSUER PURCHASES OF EQUITY SECURITIES&#39;.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;MARKET FOR REGISTRANT\&#39;S COMMON EQUITY, RELATED STOCKHOLDER MATTERS AND ISSUER PURCHASES OF EQUITY SECURITIES\nAs of December 31, 2023, the Company\&#39;s common stock is listed on the New York Stock Exchange (NYSE) under the ticker symbol &quot;DK&quot;.\nThe following table sets forth the high and low sales prices for the Company\&#39;s common stock as reported on the NYSE for the periods indicated:\nQuarterHighLowFirst Quarter 2023$63.95$45.06Second Quarter 2023$73.94$56.12Third Quarter 2023$81.11$65.23Fourth Quarter 2023$95.00$74.51\nAs of December 31, 2023, there were approximately 342 holders of record of the Company\&#39;s common stock.\nThe Company did not repurchase any shares of its common stock during the year ended December 31, 2023.\nThe Company\&#39;s board of directors has authorized a total of $10.0 billion for share repurchases under its share repurchase program, of which $5.3 billion remained available as of December 31, 2023.\n&#39;
</pre></div>
</div>
</div>
</div>
<p>Packaged Function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_10k</span><span class="p">(</span><span class="n">company_name</span><span class="p">):</span>
    <span class="n">cik_url</span> <span class="o">=</span> <span class="n">get_cik_url</span><span class="p">(</span><span class="n">company_name</span><span class="p">)</span>
    <span class="n">html_url</span> <span class="o">=</span> <span class="n">get_10k_url</span><span class="p">(</span><span class="n">cik_url</span><span class="p">)</span>
    <span class="n">html_content</span> <span class="o">=</span> <span class="n">get_10k_file</span><span class="p">(</span><span class="n">html_url</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">extract_sections</span><span class="p">(</span><span class="n">html_content</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to my Project Collection</p>
      </div>
    </a>
    <a class="right-next"
       href="codeswitching-corpus-mining_nob.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">N-grams Pattern-mining in Menus</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-objectives">Project Objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline-architecture">Pipeline Architecture</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-functionality">1. Search Functionality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parse-functionality">2. Parse Functionality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">3. Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-of-sections">Post-Processing of sections</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimenting-with-llm">Experimenting with LLM</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>